<<<<<<< HEAD
<style>
		.table {
			border-collapse: collapse;
			width: 100%;
			text-align: center;
		}
		.table td {
			border: 1px solid #ccc;
			line-height: 2em;
		}
		.table tr.current {
			background-color: #ededed;
		}
		.none {
			display: none;
		}
		.btn {
			padding: .5em 1em;
			border-radius: 3px;
			background-color: teal;
			color: #ededed;
			cursor: pointer;
			display: inline-block;
		}
		.btns {
			margin-bottom: .5em;
		}
</style>

	<div>地址管理</div>

		<div class="btns">
		<div id="btn_add" class="btn">添加</div>
		<div id="btn_import" class="btn">批量导入</div>
		<div id="btn_dels" class="btn">批量删除</div>
	</div>
	
	<div style="margin-bottom: .5em">
		<!-- 表单 -->
		<form action="javascript:void(0)">
			<input type="hidden" name="id"/>
			address<input type="text" name="address"/>
			telephone <input type="text" name="telephone"/>
			customerId <input type="text" name="customerId"/>
			<input type="submit" value="提交">
		</form>
	</div>
		<table class="table" id="address_tbl">
		<thead>
			<tr>
				<td width="80px">编号</td>
				<td>address</td>
				<td>telephone</td>
				<td>customerId</td>
				<td width="100px">操作</td>
			</tr>
		</thead>
		<tbody>
			<tr class="none">
				<td><input type="checkbox"></td>
				<td></td>
				<td></td>
				<td></td>
				<td>
					<a class="btn_del" href="#">删除</a>
					<a class="btn_upd" href="#">修改</a>
				</td>
			</tr>
		</tbody>
	</table>


<script src="https://cdn.bootcss.com/jquery/3.4.1/jquery.min.js"></script>
<script>
		// 当光标移动的某一行上，为这一行添加背景
		$("tbody").mouseover(function(event){
			var target = event.target;
			if(target.nodeName === "TD"){
				target.parentNode.className = "current"
			}
		});
		$("tbody").mouseout(function(event){
			var target = event.target;
			if(target.nodeName === "TD"){
				target.parentNode.className = ""
			}
		});



		var baseURL = "http://134.175.154.93:6677"

		var btn_add = document.getElementById("btn_add");
		var tbody = document.getElementsByTagName("tbody")[0];
		// 为表单绑定事件
		document.forms[0].onsubmit = function(event){
			// 1. 获取用户的输入
			var id = document.querySelector("input[name=id]").value;
			var address = document.querySelector("input[name=address]").value;
			var telephone = document.querySelector("input[name=telephone]").value;
			var customerId = document.querySelector("input[name=customerId]").value;

			var url = baseURL+"/address/insertAddress";
			var data ={
				id:id,
				address:address,
				telephone:telephone,
				customerId:customerId
			};

			$.post(url,data,function(a,b){
				alert(a.message);
				console.log(a.message);
				reloadData();
			});
				event.preventDefault();
		}


// 异步提交给后台
			// var xhr = new XMLHttpRequest();
			// xhr.open("POST",baseURL+"/address/insertAddress");
			// xhr.responseType = "json";
			// // 向后台声明我们给后台传递的数据是查询字符串
			// xhr.setRequestHeader("Content-Type","application/x-www-form-urlencoded");
			// // 将数据转换为查询字符串传递给后台
			// var data ;
			// if(id){
			// 	data = "id="+id+"&address="+address+"&telephone="+telephone+"&customerId="+customerId;
			// } else {
			// 	data = "&address="+address+"&telephone="+telephone+"&customerId="+customerId;
			// }			 
			// xhr.send(data);

			// xhr.onreadystatechange = function(){
			// 	if(this.readyState === 4){
			// 		if(this.status === 200){
			// 			console.log(this.response);
			// 			if(this.response.status === 200){
			// 				alert(this.response.message);
			// 				reloadData();
			// 			} else {
			// 				alert("接口异常");
			// 			}
			// 		}
			// 	}
			// }
			// 	event.preventDefault();
			// }


		// 给添加按钮绑定事件
			btn_add.onclick = function(){
			document.querySelector("input[name=address]").value = "";
			document.querySelector("input[name=telephone]").value = "";
			document.querySelector("input[name=customerId]").value = "";
			document.querySelector("input[name=id]").value = "";
			
		}

		// 给删除按钮绑定事件
		tbody.onclick = function(event){
			if(event.target.nodeName === "A"){
				switch(event.target.className){
					case "btn_del":
						// 1. 先获取要删除的id
						var id = event.target.parentNode.parentNode.firstElementChild.firstElementChild.value;
						// 2. 编写ajax进行删除
						var url = baseURL+"/address/deleteAddressById";
						var data = "id="+id;
						$.post(url,data,function(response,status){
							alert(response.message);
							reloadData();
						});
						break;

					case "btn_upd":
						// var url = baseURL+"/address/updateAddressPrimaryKey";
						// var id = event.target.parentNode.parentNode.children[0].firstElementChild.value;
						// console.log(id);
						// var address = event.target.parentNode.parentNode.children[1].innerText;
						// var telephone = event.target.parentNode.parentNode.children[2].innerText;
						// var customerId = event.target.parentNode.parentNode.children[3].innerText;
						// document.querySelector("input[name=address]").value = address;
						// document.querySelector("input[name=telephone]").value = telephone;
						// document.querySelector("input[name=customerId]").value = customerId;
						// document.querySelector("input[name=id]").value = id;
						// var data ={
						// 	id:id,
						// 	realname:realname,
						// 	telephone:telephone
						// };

						// $.post(url,data,function(a,b){
						// 	alert(a.message);
						// 	reloadData();
						// });


						var id = event.target.parentNode.parentNode.children[0].firstElementChild.value;
						console.log(id);
						var address = event.target.parentNode.parentNode.children[1].innerText;
						var telephone = event.target.parentNode.parentNode.children[2].innerText;
						var customerId = event.target.parentNode.parentNode.children[3].innerText;
						document.querySelector("input[name=address]").value = address;
						document.querySelector("input[name=telephone]").value = telephone;
						document.querySelector("input[name=customerId]").value = customerId;
						document.querySelector("input[name=id]").value = id;
						break;
				}
			}
		}


		// 重载数据
		function reloadData(){
			//1. 通过ajax获取后台数据
			var url = baseURL+"/address/findAddressAll ";
			$.get(url,function(response,status){
				// 先将tbody原有的数据删除掉
				Array.prototype.slice.call(tbody.children,0).forEach(function(item,index){
					if(index !== 0 ){
						tbody.removeChild(item)
					}
				})
				//2. 将查询到的数据渲染到页面中
				response.data.forEach(function(item){
					// 2.1 创建一个tr,然后将数据添加到tr中
					var newTr = tbody.firstElementChild.cloneNode(true);
					newTr.children[0].firstElementChild.value = item.id;
					newTr.children[1].innerText = item.address;
					// newTr.children[2].innerText = item.status;
					newTr.children[2].innerText = item.telephone;
					newTr.children[3].innerText = item.customerId;
					newTr.setAttribute("class","");
					// 2.2 将tr追加到tbody中
					tbody.appendChild(newTr);
				})
			})
		}
		reloadData();

	// 	function reloadData(){
	// 	var url = baseURL+"/address/findAddressAll";
	// 	$.get(url,function(response,status){
	// 		//1. 将tbody清空
	// 		$("#address_tbl tbody").empty();
	// 		//2. 追加新的值
	// 		response.data.forEach(function(item){
	// 			var newTr = $(`<tr>
	// 				<td><input type="checkbox" value="`+item.id+`"></td>
	// 				<td>`+item.address+`</td>
	// 				<td>`+item.telephone+`</td>
	// 				<td>`+item.customerId+`</td>
	// 				<td>
	// 					<a class="btn_del" href="#">删除</a>
	// 					<a class="btn_upd" href="#">修改</a>
	// 				</td>
	// 			</tr>`);
	// 			$("#address_tbl").append(newTr)
	// 		});
	// 	});
	// }

	// // 文档加载完毕之后执行
	// $(function(){
	// 	//调用重载数据
	// 	reloadData();
	// })





</script>
=======
你好
>>>>>>> 4d18ae3914d303f98f4a71067bb6624f215509f7
